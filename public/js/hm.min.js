var hm=function(){var a=function(a){hm.shell.initModule(a)};return{initModule:a}}();hm.map=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m={base_html:String()+'<div class="hm-map-canvas-container"><div class="hm-map-canvas"></div></div><div class="hm-map-places"></div>',place_html:String()+'<div class="hm-map-places-place"><div class="hm-map-places-place-key-wrapper"><div class="hm-map-places-place-key"></div></div><div class="hm-map-places-place-distance"></div><div class="hm-map-places-place-info"><div class="hm-map-places-place-name"></div><div class="hm-map-places-place-address"></div></div><a class="hm-map-places-place-remove" href="#">x</a></div>',map_zoom:14,search_distance:16093,marker_label_class:"hm-map-label",marker_label_width:50,map_styles:[{featureType:"administrative",stylers:[{visibility:"simplified"}]},{stylers:[{hue:"#0091ff"},{saturation:-39},{lightness:4},{gamma:.89}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{lightness:30},{weight:3.1}]}],on_places_changed:null,settable_map:{on_places_changed:!0,marker_label_class:!0}},n={$mapArea:void 0,map:void 0,origin:void 0,markers:{},place_info:{},origin_marker:void 0},o={places:{}};return d=function(){o.$mapArea=n.$mapArea,o.$mapCanvas=o.$mapArea.find(".hm-map-canvas"),o.$places=o.$mapArea.find(".hm-map-places")},a=function(a){return hm.util.setConfigMap({input_map:a,settable_map:m.settable_map,config_map:m}),!0},c=function(){n.geocoder=new google.maps.Geocoder,n.infoWindow=new google.maps.InfoWindow,n.distanceMatrix=new google.maps.DistanceMatrixService;var a={zoom:m.map_zoom,styles:m.map_styles};n.map=new google.maps.Map(o.$mapCanvas[0],a),n.places=new google.maps.places.PlacesService(n.map)},g=function(a,b){var c,d=n.map,e=new google.maps.LatLng(a,b);return c=new MarkerWithLabel({map:d,position:e,draggable:!1,labelAnchor:google.maps.Point(25,0),labelContent:"",labelClass:m.marker_label_class})},e=function(a){var b,c=$(m.place_html),d=a.id;c.find(".hm-map-places-place-name").html(a.name),c.find(".hm-map-places-place-address").html(a.address),c.find(".hm-map-places-place-distance").html(a.origin_distance),c.find(".hm-map-places-place-remove").bind("click",l),c.attr("id",a.id),o.$places.append(c),o.places[a.id]=c,b=g(a.latitude,a.longitude,a.name,a.id),n.markers[d]=b,n.place_info[d]=a},f=function(){var a,b,c=[],d=0;for(b in n.place_info)n.place_info.hasOwnProperty(b)&&(c[c.length]=n.place_info[b]);for(c.sort(function(a,b){return b.latitude-a.latitude}),o.$places.find(".hm-map-places-place").detach(),d=0;d<c.length;++d){a=c[d],i(a.id,String(d+1));var e=o.places[a.id];e.find(".hm-map-places-place-key").html(String(d+1)),o.$places.append(e)}},h=function(a){var b=n.markers[a];b.setMap(null),delete n.markers[a]},i=function(a,b){var c=n.markers[a];c.set("labelContent",b)},k=function(){},j=function(a){function b(){f(),null!==m.on_places_changed&&m.on_places_changed(n.place_info)}o.$places.html("");for(var c in n.markers)n.hasOwnProperty(c)&&n.markers[c].setMap(null);n.markers={},n.place_info={};var d=function(a,c){function d(a,c){n.distanceMatrix.getDistanceMatrix({origins:[n.origin],destinations:[new google.maps.LatLng(a.latitude,a.longitude)],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},function(d){var f=d.rows[0].elements[0].distance.text,g=d.rows[0].elements[0].distance.value;a.origin_distance=f,a.origin_distance_value=g,e(a),c&&(console.log("Finished creating places"),b())})}if(c!=google.maps.places.PlacesServiceStatus.OK)return!1;for(var f=0;f<a.length;f++){var g,h=a[f],i=f===a.length-1?!0:!1;g={address:h.vicinity,latitude:h.geometry.location.lat(),longitude:h.geometry.location.lng(),name:h.name,place_type:"",origin_distance:"",id:h.place_id},d(g,i)}return!0};return n.geocoder.geocode({address:a},function(b){var c=b[0].geometry.location;n.map.setCenter(c),n.origin=c,origin_marker=new google.maps.Marker({position:c,title:a,map:n.map,zIndex:99999,icon:"http://maps.google.com/mapfiles/ms/icons/yellow-dot.png"});var e={location:n.origin,radius:String(m.search_distance),types:["lodging"]};n.places.nearbySearch(e,d)}),!0},l=function(a){a.preventDefault();var b,c=$(a.target);b=c.parent().attr("id"),h(b),c.parent().detach(),delete n.place_info[b],delete o.places[b],f()},b=function(a){n.$mapArea=a,a.html(m.base_html),d(),c()},{setOrigin:j,initModule:b,configModule:a,map:n.map,createMarker:g,removeMarker:h,setMarkerLabel:i}}(),hm.menu=function(){function a(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function b(b,c,d){return b.replace(new RegExp(a(c),"g"),d)}var c,d,e,f,g,h,i,j={main_html:String()+'<div class="hm-menu-section"><div class="hm-menu-section-header"><div class="hm-menu-section-header-title">Origin</div></div><div class="hm-menu-section-body"><input id="origin-input" type="text"></input></div></div><div class="hm-menu-section"><div class="hm-menu-section-header"><div class="hm-menu-section-header-title">CSV Download</div></div><div class="hm-menu-section-body"><a id="hm-menu-csv-download">Download CSV File</a></div></div>',location_html:String()+'<li class="hm-locations-loc"><div class="hm-locations-loc-remove-btn">-</div><div class="hm-locations-loc-name"></div><div class="hm-locations-loc-addr"></div></li>',menu_open_time:250,menu_close_time:250,menu_open_size_px:300,set_menu_anchor:null,set_origin_anchor:null,settable_map:{menu_open_time:!0,menu_close_time:!0,menu_open_size_px:!0,set_menu_anchor:!0,set_origin_anchor:!0}},k={},l={position_type:"closed",origin:"",places:{}};return f=function(a){return hm.util.setConfigMap({input_map:a,settable_map:j.settable_map,config_map:j}),!0},i=function(){var a=l.$menuContainer,b=l.$menuButton;k={$menuButton:b,$menuContainer:a,$originInput:a.find("#origin-input"),$locationsList:a.find(".hm-menu-locations-list"),$downloadAnchor:a.find("#hm-menu-csv-download")}},g=function(a){console.log("Setting download link:",a);var c,d,e,f="%0A",g="%09",h="data:application/octet-stream,",i=["name","address","origin_distance"];for(c=0;c<i.length;++c)h+=c===i.length-1?i[c]+f:i[c]+g;for(e in a)if(a.hasOwnProperty(e))for(d=a[e],c=0;c<i.length;++c)h+=b(d[i[c]]," ","%20"),h+=c===i.length-1?f:g;console.log("Link text: ",h),k.$downloadAnchor.attr("href",h)},setCurrentOriginState=function(a){var b;switch(a){case"saved":b="green";break;case"unsaved":b="yellow";break;case"invalid":b="red"}k.$originInput.css("border-color",b)},c=function(a){var b;if(l.position_type===a)return!0;switch(a){case"opened":left_px="0px",b=j.menu_open_time;break;case"closed":left_px=String(-1*j.menu_open_size_px)+"px",b=j.menu_close_time;break;default:return!1}return l.position_type="",k.$menuContainer.animate({left:left_px},b,function(){l.position_type=a}),!0},onClickToggle=function(){var a=j.set_menu_anchor;return"opened"===l.position_type?a("closed"):"closed"===l.position_type&&a("opened"),!1},onOriginKeypress=function(a){var b=k.$originInput,c=b.val();13===a.keyCode&&""!=c&&j.set_origin_anchor(c),set_menu_anchor("closed")},h=function(a){console.log("place requested:"),console.log(a);var b=a.address,c=a.name,d=(a.origin_distance,$(j.location_html));d.find(".hm-locations-loc-name").html(c),d.find("hm-locations-loc-addr").html(b),k.$locationsList.append(d)},d=function(a,b){a.css("width",String(j.menu_open_size_px)+"px"),a.css("left",String(-1*j.menu_open_size_px)+"px"),a.html(j.main_html),l.$menuContainer=a,l.$menuButton=b,i(),l.position_type="closed",k.$menuButton.click(onClickToggle),k.$originInput.keypress(onOriginKeypress)},{setPosition:c,initModule:d,addPlace:h,configModule:f,setDownloadLink:g,handleResize:e}}();var hm=function(){var a=function(a){hm.shell.initModule(a)};return{initModule:a}}();hm.map=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m={base_html:String()+'<div class="hm-map-canvas-container"><div class="hm-map-canvas"></div></div><div class="hm-map-places"></div>',place_html:String()+'<div class="hm-map-places-place"><div class="hm-map-places-place-key-wrapper"><div class="hm-map-places-place-key"></div></div><div class="hm-map-places-place-distance"></div><div class="hm-map-places-place-info"><div class="hm-map-places-place-name"></div><div class="hm-map-places-place-address"></div></div><a class="hm-map-places-place-remove" href="#">x</a></div>',map_zoom:14,search_distance:16093,marker_label_class:"hm-map-label",marker_label_width:50,map_styles:[{featureType:"administrative",stylers:[{visibility:"simplified"}]},{stylers:[{hue:"#0091ff"},{saturation:-39},{lightness:4},{gamma:.89}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{lightness:30},{weight:3.1}]}],on_places_changed:null,settable_map:{on_places_changed:!0,marker_label_class:!0}},n={$mapArea:void 0,map:void 0,origin:void 0,markers:{},place_info:{},origin_marker:void 0},o={places:{}};return d=function(){o.$mapArea=n.$mapArea,o.$mapCanvas=o.$mapArea.find(".hm-map-canvas"),o.$places=o.$mapArea.find(".hm-map-places")},a=function(a){return hm.util.setConfigMap({input_map:a,settable_map:m.settable_map,config_map:m}),!0},c=function(){n.geocoder=new google.maps.Geocoder,n.infoWindow=new google.maps.InfoWindow,n.distanceMatrix=new google.maps.DistanceMatrixService;var a={zoom:m.map_zoom,styles:m.map_styles};n.map=new google.maps.Map(o.$mapCanvas[0],a),n.places=new google.maps.places.PlacesService(n.map)},g=function(a,b){var c,d=n.map,e=new google.maps.LatLng(a,b);return c=new MarkerWithLabel({map:d,position:e,draggable:!1,labelAnchor:google.maps.Point(25,0),labelContent:"",labelClass:m.marker_label_class})},e=function(a){var b,c=$(m.place_html),d=a.id;c.find(".hm-map-places-place-name").html(a.name),c.find(".hm-map-places-place-address").html(a.address),c.find(".hm-map-places-place-distance").html(a.origin_distance),c.find(".hm-map-places-place-remove").bind("click",l),c.attr("id",a.id),o.$places.append(c),o.places[a.id]=c,b=g(a.latitude,a.longitude,a.name,a.id),n.markers[d]=b,n.place_info[d]=a},f=function(){var a,b,c=[],d=0;for(b in n.place_info)n.place_info.hasOwnProperty(b)&&(c[c.length]=n.place_info[b]);for(c.sort(function(a,b){return b.latitude-a.latitude}),o.$places.find(".hm-map-places-place").detach(),d=0;d<c.length;++d){a=c[d],i(a.id,String(d+1));var e=o.places[a.id];e.find(".hm-map-places-place-key").html(String(d+1)),o.$places.append(e)}},h=function(a){var b=n.markers[a];b.setMap(null),delete n.markers[a]},i=function(a,b){var c=n.markers[a];c.set("labelContent",b)},k=function(){},j=function(a){function b(){f(),null!==m.on_places_changed&&m.on_places_changed(n.place_info)}o.$places.html("");for(var c in n.markers)n.hasOwnProperty(c)&&n.markers[c].setMap(null);n.markers={},n.place_info={};var d=function(a,c){function d(a,c){n.distanceMatrix.getDistanceMatrix({origins:[n.origin],destinations:[new google.maps.LatLng(a.latitude,a.longitude)],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},function(d){var f=d.rows[0].elements[0].distance.text,g=d.rows[0].elements[0].distance.value;a.origin_distance=f,a.origin_distance_value=g,e(a),c&&(console.log("Finished creating places"),b())})}if(c!=google.maps.places.PlacesServiceStatus.OK)return!1;for(var f=0;f<a.length;f++){var g,h=a[f],i=f===a.length-1?!0:!1;g={address:h.vicinity,latitude:h.geometry.location.lat(),longitude:h.geometry.location.lng(),name:h.name,place_type:"",origin_distance:"",id:h.place_id},d(g,i)}return!0};return n.geocoder.geocode({address:a},function(b){var c=b[0].geometry.location;n.map.setCenter(c),n.origin=c,origin_marker=new google.maps.Marker({position:c,title:a,map:n.map,zIndex:99999,icon:"http://maps.google.com/mapfiles/ms/icons/yellow-dot.png"});var e={location:n.origin,radius:String(m.search_distance),types:["lodging"]};n.places.nearbySearch(e,d)}),!0},l=function(a){a.preventDefault();var b,c=$(a.target);b=c.parent().attr("id"),h(b),c.parent().detach(),delete n.place_info[b],delete o.places[b],f()},b=function(a){n.$mapArea=a,a.html(m.base_html),d(),c()},{setOrigin:j,initModule:b,configModule:a,map:n.map,createMarker:g,removeMarker:h,setMarkerLabel:i}}(),hm.menu=function(){function a(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function b(b,c,d){return b.replace(new RegExp(a(c),"g"),d)}var c,d,e,f,g,h,i,j={main_html:String()+'<div class="hm-menu-section"><div class="hm-menu-section-header"><div class="hm-menu-section-header-title">Origin</div></div><div class="hm-menu-section-body"><input id="origin-input" type="text"></input></div></div><div class="hm-menu-section"><div class="hm-menu-section-header"><div class="hm-menu-section-header-title">CSV Download</div></div><div class="hm-menu-section-body"><a id="hm-menu-csv-download">Download CSV File</a></div></div>',location_html:String()+'<li class="hm-locations-loc"><div class="hm-locations-loc-remove-btn">-</div><div class="hm-locations-loc-name"></div><div class="hm-locations-loc-addr"></div></li>',menu_open_time:250,menu_close_time:250,menu_open_size_px:300,set_menu_anchor:null,set_origin_anchor:null,settable_map:{menu_open_time:!0,menu_close_time:!0,menu_open_size_px:!0,set_menu_anchor:!0,set_origin_anchor:!0}},k={},l={position_type:"closed",origin:"",places:{}};return f=function(a){return hm.util.setConfigMap({input_map:a,settable_map:j.settable_map,config_map:j}),!0},i=function(){var a=l.$menuContainer,b=l.$menuButton;k={$menuButton:b,$menuContainer:a,$originInput:a.find("#origin-input"),$locationsList:a.find(".hm-menu-locations-list"),$downloadAnchor:a.find("#hm-menu-csv-download")}},g=function(a){console.log("Setting download link:",a);var c,d,e,f="%0A",g="%09",h="data:application/octet-stream,",i=["name","address","origin_distance"];for(c=0;c<i.length;++c)h+=c===i.length-1?i[c]+f:i[c]+g;for(e in a)if(a.hasOwnProperty(e))for(d=a[e],c=0;c<i.length;++c)h+=b(d[i[c]]," ","%20"),h+=c===i.length-1?f:g;console.log("Link text: ",h),k.$downloadAnchor.attr("href",h)},setCurrentOriginState=function(a){var b;switch(a){case"saved":b="green";break;case"unsaved":b="yellow";break;case"invalid":b="red"}k.$originInput.css("border-color",b)},c=function(a){var b;if(l.position_type===a)return!0;switch(a){case"opened":left_px="0px",b=j.menu_open_time;break;case"closed":left_px=String(-1*j.menu_open_size_px)+"px",b=j.menu_close_time;break;default:return!1}return l.position_type="",k.$menuContainer.animate({left:left_px},b,function(){l.position_type=a}),!0},onClickToggle=function(){var a=j.set_menu_anchor;return"opened"===l.position_type?a("closed"):"closed"===l.position_type&&a("opened"),!1},onOriginKeypress=function(a){var b=k.$originInput,c=b.val();13===a.keyCode&&""!=c&&j.set_origin_anchor(c),set_menu_anchor("closed")},h=function(a){console.log("place requested:"),console.log(a);var b=a.address,c=a.name,d=(a.origin_distance,$(j.location_html));d.find(".hm-locations-loc-name").html(c),d.find("hm-locations-loc-addr").html(b),k.$locationsList.append(d)},d=function(a,b){a.css("width",String(j.menu_open_size_px)+"px"),a.css("left",String(-1*j.menu_open_size_px)+"px"),a.html(j.main_html),l.$menuContainer=a,l.$menuButton=b,i(),l.position_type="closed",k.$menuButton.click(onClickToggle),k.$originInput.keypress(onOriginKeypress)},{setPosition:c,initModule:d,addPlace:h,configModule:f,setDownloadLink:g,handleResize:e}}(),hm.model=function(){"use strict";var a,b;a={get_color:function(){return this._color},get_location:function(){return{latitude:this.latitude,longitude:this.longitude}}},b=function(b){var c,d=b.address,e=b.name,f=b.distance;return latitude=b.latitude,longitude=b.longitude,c=Object.create(a),c.address=d,c.name=e,c.latitude=latitude,c.longitude=longitude,c.distance=f?f:"unknown",c}}(),hm.shell=function(){var a,b,c,d,e,f,g,h,i,j={anchor_schema_map:{menu:{opened:!0,closed:!0},origin:!0},resize_interval:200,main_html:String()+'<header class="hm-shell-header"><div class="hm-shell-header-menu-btn">=</div><div class="hm-shell-header-logo">Outward</div></header><div class="hm-shell-menu"></div><div class="hm-shell-map"></div><div class="hm-shell-places"></div><div class="hm-shell-modal"></div><div class="hm-shell-footer"></div>'},k={$container:void 0},l={};return a=function(){return $.extend(!0,{},k.anchor_map)},b=function(){var a=k.$container;l={$container:a,$menuContainer:a.find(".hm-shell-menu"),$menuButton:a.find(".hm-shell-header-menu-btn"),$mapArea:a.find(".hm-shell-map")}},c=function(b){var c,d,e=a(),f=!0;a:for(c in b)if(b.hasOwnProperty(c)){if(0===c.indexOf("_"))continue a;e[c]=b[c],d="_"+c,b[d]?e[d]=b[d]:(delete e[d],delete e["_s"+d])}try{$.uriAnchor.setAnchor(e)}catch(g){$.uriAnchor.setAnchor(k.anchor_map,null,!0),f=!1}return f},d=function(){console.log("Handling hash change");var b,c,d,e,f,g,h=!0,i=a();try{g=$.uriAnchor.makeAnchorMap()}catch(j){return $.uriAnchor.setAnchor(i,null,!0),!1}if(k.anchor_map=g,console.log("Proposed anchor map: ",g),b=i._s_menu,c=g._s_menu,e=i._s_origin,f=g._s_origin,!i||b!==c)switch(d=g.menu){case"opened":h=hm.menu.setPosition("opened");break;case"closed":h=hm.menu.setPosition("closed");break;default:hm.menu.setPosition("closed"),delete g.menu,$.uriAnchor.setAnchor(g,null,!0)}return i&&f===e||hm.map.setOrigin(f),h||(i?($.uriAnchor.setAnchor(i,null,!0),k.anchor_map=i):(delete g.chat,$.uriAnchor.setAnchor(g,null,!0))),!1},e=function(){return k.resize_idto?!0:(k.resize_idto=setTimeout(function(){k.resize_idto=void 0},j.resize_interval),console.log("Handling resize"),!0)},h=function(a){return c({menu:a})},f=function(a){return c({origin:a})},i=function(a){console.log("Places changed: ",a),hm.menu.setDownloadLink(a)},g=function(a){k.$container=a,a.html(j.main_html),b(),$.uriAnchor.configModule({schema_map:j.anchor_schema_map}),hm.menu.configModule({set_menu_anchor:h,set_origin_anchor:f}),hm.menu.initModule(l.$menuContainer,l.$menuButton),hm.map.configModule({on_places_changed:i}),hm.map.initModule(l.$mapArea),$(window).bind("resize",e).bind("hashchange",d).trigger("hashchange")},{initModule:g}}(),hm.util=function(){var a,b,c,d;return a=function(a,b,c){var d=new Error;return d.name=a,d.message=b,c&&(d.data=c),d},b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},d=function(b){var c,d,e=b.input_map,f=b.settable_map,g=b.config_map;for(c in e)if(e.hasOwnProperty(c)){if(!f.hasOwnProperty(c))throw d=a("Bad Input","Setting config key |"+c+"| is not supported");g[c]=e[c]}},c=function(){var a=$("#hm-modal-backdrop"),b=$(".hm-modal-pane"),c="none"===a.css("display")?"":"none";a.css("display",c),b.css("display",c)},{toggleModal:c,setConfigMap:d,makeError:a,getUUID:b}}(),hm.model=function(){"use strict";var a,b;a={get_color:function(){return this._color},get_location:function(){return{latitude:this.latitude,longitude:this.longitude}}},b=function(b){var c,d=b.address,e=b.name,f=b.distance;return latitude=b.latitude,longitude=b.longitude,c=Object.create(a),c.address=d,c.name=e,c.latitude=latitude,c.longitude=longitude,c.distance=f?f:"unknown",c}}(),hm.shell=function(){var a,b,c,d,e,f,g,h,i,j={anchor_schema_map:{menu:{opened:!0,closed:!0},origin:!0},resize_interval:200,main_html:String()+'<header class="hm-shell-header"><div class="hm-shell-header-menu-btn">=</div><div class="hm-shell-header-logo">Outward</div></header><div class="hm-shell-menu"></div><div class="hm-shell-map"></div><div class="hm-shell-places"></div><div class="hm-shell-modal"></div><div class="hm-shell-footer"></div>'},k={$container:void 0},l={};return a=function(){return $.extend(!0,{},k.anchor_map)},b=function(){var a=k.$container;l={$container:a,$menuContainer:a.find(".hm-shell-menu"),$menuButton:a.find(".hm-shell-header-menu-btn"),$mapArea:a.find(".hm-shell-map")}},c=function(b){var c,d,e=a(),f=!0;a:for(c in b)if(b.hasOwnProperty(c)){if(0===c.indexOf("_"))continue a;e[c]=b[c],d="_"+c,b[d]?e[d]=b[d]:(delete e[d],delete e["_s"+d])}try{$.uriAnchor.setAnchor(e)}catch(g){$.uriAnchor.setAnchor(k.anchor_map,null,!0),f=!1}return f},d=function(){console.log("Handling hash change");var b,c,d,e,f,g,h=!0,i=a();try{g=$.uriAnchor.makeAnchorMap()}catch(j){return $.uriAnchor.setAnchor(i,null,!0),!1}if(k.anchor_map=g,console.log("Proposed anchor map: ",g),b=i._s_menu,c=g._s_menu,e=i._s_origin,f=g._s_origin,!i||b!==c)switch(d=g.menu){case"opened":h=hm.menu.setPosition("opened");break;case"closed":h=hm.menu.setPosition("closed");break;default:hm.menu.setPosition("closed"),delete g.menu,$.uriAnchor.setAnchor(g,null,!0)}return i&&f===e||hm.map.setOrigin(f),h||(i?($.uriAnchor.setAnchor(i,null,!0),k.anchor_map=i):(delete g.chat,$.uriAnchor.setAnchor(g,null,!0))),!1},e=function(){return k.resize_idto?!0:(k.resize_idto=setTimeout(function(){k.resize_idto=void 0},j.resize_interval),console.log("Handling resize"),!0)},h=function(a){return c({menu:a})},f=function(a){return c({origin:a})},i=function(a){console.log("Places changed: ",a),hm.menu.setDownloadLink(a)},g=function(a){k.$container=a,a.html(j.main_html),b(),$.uriAnchor.configModule({schema_map:j.anchor_schema_map}),hm.menu.configModule({set_menu_anchor:h,set_origin_anchor:f}),hm.menu.initModule(l.$menuContainer,l.$menuButton),hm.map.configModule({on_places_changed:i}),hm.map.initModule(l.$mapArea),$(window).bind("resize",e).bind("hashchange",d).trigger("hashchange")},{initModule:g}}(),hm.util=function(){var a,b,c,d;return a=function(a,b,c){var d=new Error;return d.name=a,d.message=b,c&&(d.data=c),d},b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},d=function(b){var c,d,e=b.input_map,f=b.settable_map,g=b.config_map;for(c in e)if(e.hasOwnProperty(c)){if(!f.hasOwnProperty(c))throw d=a("Bad Input","Setting config key |"+c+"| is not supported");g[c]=e[c]}},c=function(){var a=$("#hm-modal-backdrop"),b=$(".hm-modal-pane"),c="none"===a.css("display")?"":"none";a.css("display",c),b.css("display",c)},{toggleModal:c,setConfigMap:d,makeError:a,getUUID:b}}();